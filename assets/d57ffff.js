(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{587:function(e,t,a){"use strict";a.r(t);var n=a(455),i=a(438),r=a(466),s=a(458),o=a(503),c=a(456),d=a(585),l=a(608),u=a(582),m=a(437),p=a(518),f=a(451),v=a(496),h=a(64),b=a(457),I=(a(34),a(17),a(16),a(18),a(6),a(24),a(19),a(25),a(4)),x=a(3),y=(a(22),a(56),a(83));function g(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function _(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?g(Object(a),!0).forEach((function(t){Object(x.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):g(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var O={data:function(){return{valid:!0,editedIndex:-1,input:!1,isadmin:!1,dialog:!1,rules:{required:function(e){return!!e||"Field Required"}},headers:[{text:"Id",sortable:!1,value:"id"},{text:"Calories",value:"name"},{text:"External ID",value:"externalId"},{text:"Tarrif Enabled",value:"isTariffEnabled"},{text:"Action",value:"actions"}],editedItem:{id:0,name:"",externalId:""},defaultItem:{id:0,name:"",externalId:""}}},computed:_(_({},Object(y.c)({companies:"companies"})),{},{formTitle:function(){return-1===this.editedIndex?"Create new company":"Edit company"}}),watch:{companyname:function(e){e.length>2?this.save=!0:this.save=!1},dialog:function(e){e||this.close()}},created:function(){var e=localStorage.getItem("userId");this.fetchuseraccount(e),this.$store.dispatch("_fetchcompanies")},methods:{savecompany:function(){var e=this;this.$store.dispatch("_registercompany",this.editedItem).then((function(){e.editedItem=e.defaultItem,e.save=!1,e.input=!1}))},editItem:function(e){this.editedIndex=this.companies.indexOf(e),this.editedItem=Object.assign({},e),this.dialog=!0},close:function(){var e=this;this.dialog=!1,this.$nextTick((function(){e.editedItem=Object.assign({},e.defaultItem),e.editedIndex=-1})),setTimeout((function(){e.$store.dispatch("_fetchcompanies")}),5e3)},save:function(){this.$refs.form.validate()&&(this.editedIndex>-1?this.$store.dispatch("_updatecompany",{id:this.editedItem.id,payload:this.editedItem}):this.$store.dispatch("_registercompany",this.editedItem),this.close())},fetchuseraccount:function(e){var t=this;return Object(I.a)(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,t.$api.$get("/users/".concat(e)).then((function(e){t.isadmin="ADMIN"===e.role,t.meter.companyId=e.companyId})).catch((function(e){}));case 2:case"end":return a.stop()}}),a)})))()}}},w=a(59),k=Object(w.a)(O,(function(){var e=this,t=e._self._c;return e.companies?t(d.a,{staticClass:"elevation-1",attrs:{headers:e.headers,items:e.companies,"items-per-page":5},scopedSlots:e._u([{key:"top",fn:function(){return[t(h.a,{attrs:{flat:""}},[t(b.a,{staticClass:"font-weight-bold"},[e._v("\n        Companies\n      ")]),e._v(" "),t(f.a),e._v(" "),t(l.a,{attrs:{"max-width":"60%"},scopedSlots:e._u([{key:"activator",fn:function(a){var n=a.on,r=a.attrs;return[t(i.a,e._g(e._b({staticClass:"mb-2",attrs:{color:"primary",dark:""}},"v-btn",r,!1),n),[t(m.a,{attrs:{left:""}},[e._v("\n              mdi-domain-plus\n            ")]),e._v("\n            New Company\n          ")],1)]}}],null,!1,1946524986),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),t(r.a,[t(n.a,{attrs:{color:"primary",dark:"",flat:""}},[t("span",{staticClass:"text-h5 font-weight-bold"},[e._v(e._s(e.formTitle))])]),e._v(" "),t(s.b,[t(u.a,{ref:"form",attrs:{"lazy-validation":""},model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[t(c.a,[t(p.a,[t(o.a,{attrs:{cols:"12",sm:"6",md:"6"}},[t(v.a,{attrs:{filled:"",rules:[e.rules.required],label:"Company Name"},model:{value:e.editedItem.name,callback:function(t){e.$set(e.editedItem,"name",t)},expression:"editedItem.name"}})],1),e._v(" "),t(o.a,{attrs:{cols:"12",sm:"6",md:"6"}},[t(v.a,{attrs:{rules:[e.rules.required],label:"External ID"},model:{value:e.editedItem.externalId,callback:function(t){e.$set(e.editedItem,"externalId",t)},expression:"editedItem.externalId"}})],1)],1)],1)],1)],1),e._v(" "),t(s.a,[t(f.a),e._v(" "),t(i.a,{attrs:{color:"primary darken-1",small:""},on:{click:e.close}},[e._v("\n              Cancel\n            ")]),e._v(" "),t(i.a,{attrs:{color:"warning darken-1",small:""},on:{click:e.save}},[e._v("\n              Save\n            ")])],1)],1)],1),e._v(" "),t("export-button",{attrs:{report:"companies"}})],1)]},proxy:!0},{key:"item.actions",fn:function(a){var n=a.item;return[t(m.a,{staticClass:"mr-2",attrs:{small:""},on:{click:function(t){return e.editItem(n)}}},[e._v("\n      mdi-pencil\n    ")])]}}],null,!1,3781329680)}):t("skeleton-table-loader")}),[],!1,null,null,null);t.default=k.exports}}]);